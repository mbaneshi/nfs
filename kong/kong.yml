_format_version: "3.0"

services:
  - name: supabase-auth
    url: http://supabase-auth:9999
    routes:
      - name: supabase-auth-route
        strip_path: true
        paths:
          - /auth/v1
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: supabase-rest
    url: http://supabase-rest:3000
    routes:
      - name: supabase-rest-route
        strip_path: true
        paths:
          - /rest/v1
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: supabase-realtime
    url: http://supabase-realtime:4000
    routes:
      - name: supabase-realtime-route
        strip_path: true
        paths:
          - /realtime/v1
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: supabase-storage
    url: http://supabase-storage:5000
    routes:
      - name: supabase-storage-route
        strip_path: true
        paths:
          - /storage/v1
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: backend-api
    url: http://backend:8000
    routes:
      - name: backend-api-route
        strip_path: true
        paths:
          - /api/v1
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: n8n-automation
    url: http://n8n:5678
    routes:
      - name: n8n-automation-route
        strip_path: true
        paths:
          - /automation
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: minio-storage
    url: http://minio:9000
    routes:
      - name: minio-storage-route
        strip_path: true
        paths:
          - /storage
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false

  - name: supabase-studio
    url: http://supabase-studio:3000
    routes:
      - name: supabase-studio-route
        strip_path: true
        paths:
          - /studio
    plugins:
      - name: cors
        config:
          origins:
            - "https://app.edcopo.info"
            - "https://api.edcopo.info"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Accept-Version
            - Content-Length
            - Content-MD5
            - Content-Type
            - Date
            - X-Auth-Token
            - Authorization
          exposed_headers:
            - X-Auth-Token
          credentials: true
          max_age: 3600
          preflight_continue: false
